# 分布式和微服务有什么区别？

## 概念定义

```
┌─────────────────────────────────────────────────────────────┐
│                    分布式 vs 微服务                          │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│   分布式 (Distributed):                                     │
│   ├── 一个系统的不同模块部署在不同机器上                    │
│   ├── 通过网络协作完成任务                                  │
│   ├── 解决的是「部署」问题                                  │
│   └── 强调的是「分散」                                      │
│                                                             │
│   微服务 (Microservices):                                   │
│   ├── 一种架构风格，将应用拆分为小型服务                    │
│   ├── 每个服务独立开发、部署、扩展                          │
│   ├── 解决的是「架构」问题                                  │
│   └── 强调的是「拆分」                                      │
│                                                             │
│   关系:                                                      │
│   微服务是分布式的一种架构风格                              │
│   分布式不一定是微服务                                      │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

## 架构对比

```
┌─────────────────────────────────────────────────────────────┐
│                    单体 → 分布式 → 微服务                    │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│   单体架构:                                                  │
│   ┌─────────────────────────────────────────────────────┐  │
│   │                    应用服务器                        │  │
│   │   ┌───────────────────────────────────────────────┐ │  │
│   │   │  用户模块 │ 订单模块 │ 商品模块 │ 支付模块    │ │  │
│   │   └───────────────────────────────────────────────┘ │  │
│   │   所有模块在一个进程中，共用数据库                  │  │
│   └─────────────────────────────────────────────────────┘  │
│                                                             │
│   分布式架构:                                                │
│   ┌─────────────────────────────────────────────────────┐  │
│   │   ┌─────────┐   ┌─────────┐   ┌─────────┐          │  │
│   │   │ Server1 │   │ Server2 │   │ Server3 │          │  │
│   │   │ 用户+订单│   │ 商品    │   │ 支付    │          │  │
│   │   └─────────┘   └─────────┘   └─────────┘          │  │
│   │   模块分散部署在不同服务器                          │  │
│   │   可能还是一个大应用，只是分布式部署                │  │
│   └─────────────────────────────────────────────────────┘  │
│                                                             │
│   微服务架构:                                                │
│   ┌─────────────────────────────────────────────────────┐  │
│   │   ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐  │  │
│   │   │用户服务 │ │订单服务 │ │商品服务 │ │支付服务 │  │  │
│   │   │独立代码 │ │独立代码 │ │独立代码 │ │独立代码 │  │  │
│   │   │独立数据库│ │独立数据库│ │独立数据库│ │独立数据库│  │  │
│   │   └─────────┘ └─────────┘ └─────────┘ └─────────┘  │  │
│   │   每个服务是独立的应用，有自己的代码库、数据库      │  │
│   │   通过 API 通信                                     │  │
│   └─────────────────────────────────────────────────────┘  │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

## 核心区别

```
┌─────────────────────────────────────────────────────────────┐
│                    核心区别                                  │
├─────────────────┬──────────────────┬────────────────────────┤
│   维度          │   分布式          │   微服务               │
├─────────────────┼──────────────────┼────────────────────────┤
│   关注点        │ 部署方式          │ 架构设计              │
│   拆分粒度      │ 模块级           │ 业务服务级            │
│   数据库        │ 可共享           │ 每个服务独立          │
│   代码库        │ 可共用           │ 每个服务独立          │
│   技术栈        │ 通常统一         │ 可以不同              │
│   团队          │ 一个团队         │ 每个服务独立团队      │
│   部署          │ 可一起部署       │ 独立部署              │
├─────────────────┴──────────────────┴────────────────────────┤
│                                                             │
│   简单理解:                                                  │
│   • 分布式: 一个应用部署在多台机器 (水平扩展)               │
│   • 微服务: 一个应用拆分成多个小应用 (垂直拆分)             │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

## 分布式解决的问题

```
┌─────────────────────────────────────────────────────────────┐
│                    分布式解决的问题                          │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│   1. 性能问题                                                │
│      └── 多机器并行处理，提高吞吐量                         │
│                                                             │
│   2. 可用性问题                                              │
│      └── 多副本，一台挂了其他继续服务                       │
│                                                             │
│   3. 扩展性问题                                              │
│      └── 水平扩展，加机器解决                               │
│                                                             │
│   分布式带来的问题:                                          │
│   ┌─────────────────────────────────────────────────────┐  │
│   │  • 网络不可靠 (延迟、丢包、分区)                     │  │
│   │  • 数据一致性 (CAP 定理)                             │  │
│   │  • 分布式事务                                        │  │
│   │  • 分布式锁                                          │  │
│   │  • 运维复杂度                                        │  │
│   └─────────────────────────────────────────────────────┘  │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

## 微服务解决的问题

```
┌─────────────────────────────────────────────────────────────┐
│                    微服务解决的问题                          │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│   1. 单体应用的问题                                          │
│      ├── 代码量大，理解困难                                 │
│      ├── 构建部署慢                                         │
│      ├── 技术栈固化                                         │
│      ├── 团队协作冲突                                       │
│      └── 扩展困难 (只能整体扩展)                            │
│                                                             │
│   2. 微服务的优势                                            │
│      ├── 独立开发、部署、扩展                               │
│      ├── 技术栈自由选择                                     │
│      ├── 故障隔离                                           │
│      ├── 团队自治                                           │
│      └── 按需扩展 (只扩展热点服务)                          │
│                                                             │
│   微服务带来的问题:                                          │
│   ┌─────────────────────────────────────────────────────┐  │
│   │  • 服务间通信复杂                                    │  │
│   │  • 分布式事务                                        │  │
│   │  • 服务治理 (发现、配置、监控)                       │  │
│   │  • 数据一致性                                        │  │
│   │  • 运维复杂 (需要容器化、编排)                       │  │
│   │  • 调试困难                                          │  │
│   └─────────────────────────────────────────────────────┘  │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

## 微服务技术栈

```
┌─────────────────────────────────────────────────────────────┐
│                    微服务技术栈                              │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│   服务治理:                                                  │
│   ├── 服务发现: Nacos, Eureka, Consul                       │
│   ├── 配置中心: Nacos, Apollo, Config                       │
│   ├── 网关: Spring Cloud Gateway, Kong                      │
│   └── 负载均衡: Ribbon, LoadBalancer                        │
│                                                             │
│   服务通信:                                                  │
│   ├── RPC: Dubbo, gRPC                                      │
│   ├── HTTP: Feign, RestTemplate                             │
│   └── 消息: Kafka, RocketMQ, RabbitMQ                       │
│                                                             │
│   容错保护:                                                  │
│   ├── 熔断: Sentinel, Hystrix, Resilience4j                 │
│   └── 限流: Sentinel, Guava RateLimiter                     │
│                                                             │
│   可观测性:                                                  │
│   ├── 链路追踪: SkyWalking, Zipkin, Jaeger                  │
│   ├── 监控: Prometheus + Grafana                            │
│   └── 日志: ELK (Elasticsearch + Logstash + Kibana)         │
│                                                             │
│   部署:                                                      │
│   ├── 容器: Docker                                          │
│   └── 编排: Kubernetes                                      │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

## 面试回答

### 30秒版本

> **分布式**：将系统部署在多台机器上，通过网络协作，解决性能和可用性问题，强调「部署分散」。**微服务**：一种架构风格，将应用拆分为独立的小服务，每个服务有独立代码库和数据库，独立部署，强调「业务拆分」。关系：微服务是分布式的一种架构形式，分布式不一定是微服务。

### 1分钟版本

> **分布式**：
> - 一个系统部署在多台机器上
> - 解决性能、可用性、扩展性问题
> - 强调「水平扩展」
> - 带来问题：网络不可靠、数据一致性、分布式事务
>
> **微服务**：
> - 将应用按业务拆分成独立服务
> - 每个服务：独立代码、独立数据库、独立部署
> - 强调「垂直拆分」
> - 带来问题：服务治理、分布式事务、运维复杂
>
> **区别**：
> - 分布式关注「部署」，微服务关注「架构」
> - 分布式可能是一个大应用多机部署
> - 微服务一定是多个小应用
>
> **关系**：微服务 ⊂ 分布式

---

*关联文档：[distributed-transaction.md](distributed-transaction.md) | [service-discovery.md](service-discovery.md)*
