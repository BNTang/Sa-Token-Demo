# HTTP/1.0、HTTP/1.1、HTTP/2.0 区别

> 分类: 网络协议 | 难度: ⭐⭐⭐ | 频率: 高频

---

## 一、版本演进

```
┌──────────────────────────────────────────────────────────────────────────────────┐
│                          HTTP 版本演进                                            │
├──────────────────────────────────────────────────────────────────────────────────┤
│                                                                                  │
│   HTTP/0.9 (1991)    HTTP/1.0 (1996)    HTTP/1.1 (1997)    HTTP/2 (2015)        │
│        │                   │                   │                  │              │
│        ↓                   ↓                   ↓                  ↓              │
│    只支持 GET         短连接            长连接 (默认)        二进制协议          │
│    无请求头           有请求头           管道化              多路复用            │
│    只支持 HTML        支持多媒体         分块传输            头部压缩            │
│                       有状态码           缓存控制            服务器推送          │
│                                          Host 头部                              │
│                                                                                  │
└──────────────────────────────────────────────────────────────────────────────────┘
```

---

## 二、HTTP/1.0 vs HTTP/1.1

```
┌──────────────────────────────────────────────────────────────────────────────────┐
│                       HTTP/1.0 vs HTTP/1.1                                        │
├─────────────────────┬──────────────────────────┬─────────────────────────────────┤
│       特性           │       HTTP/1.0           │           HTTP/1.1              │
├─────────────────────┼──────────────────────────┼─────────────────────────────────┤
│  连接方式            │  短连接                   │  长连接 (Keep-Alive 默认开启)   │
│                     │  每次请求新建连接          │  连接复用，减少 TCP 握手        │
├─────────────────────┼──────────────────────────┼─────────────────────────────────┤
│  管道化              │  不支持                   │  支持 (但存在队头阻塞)          │
│  (Pipelining)       │  一问一答，串行           │  可同时发送多个请求             │
├─────────────────────┼──────────────────────────┼─────────────────────────────────┤
│  Host 头部           │  不支持                   │  必须携带 Host 头部             │
│                     │  一台服务器只能一个站点    │  支持虚拟主机，多站点共享 IP     │
├─────────────────────┼──────────────────────────┼─────────────────────────────────┤
│  分块传输            │  不支持                   │  支持 Transfer-Encoding:        │
│                     │  必须知道完整大小          │  chunked，边生成边发送           │
├─────────────────────┼──────────────────────────┼─────────────────────────────────┤
│  缓存控制            │  If-Modified-Since       │  更多缓存策略                    │
│                     │  Expires                  │  ETag, If-None-Match            │
│                     │                          │  Cache-Control                   │
├─────────────────────┼──────────────────────────┼─────────────────────────────────┤
│  断点续传            │  不支持                   │  支持 Range 请求                 │
└─────────────────────┴──────────────────────────┴─────────────────────────────────┘
```

---

## 三、HTTP/1.1 vs HTTP/2

```
┌──────────────────────────────────────────────────────────────────────────────────┐
│                       HTTP/1.1 vs HTTP/2                                          │
├─────────────────────┬──────────────────────────┬─────────────────────────────────┤
│       特性           │       HTTP/1.1           │           HTTP/2                │
├─────────────────────┼──────────────────────────┼─────────────────────────────────┤
│  传输格式            │  文本格式                 │  二进制格式 (帧)                 │
│                     │  可读性好，解析慢          │  解析快，更紧凑                  │
├─────────────────────┼──────────────────────────┼─────────────────────────────────┤
│  多路复用            │  不支持                   │  支持                            │
│                     │  一个连接一次处理一个请求   │  一个连接并行处理多个请求        │
│                     │  存在队头阻塞             │  消除 HTTP 层队头阻塞             │
├─────────────────────┼──────────────────────────┼─────────────────────────────────┤
│  头部压缩            │  不支持                   │  HPACK 压缩                      │
│                     │  每次请求完整发送头部      │  静态表 + 动态表 + 霍夫曼编码    │
├─────────────────────┼──────────────────────────┼─────────────────────────────────┤
│  服务器推送          │  不支持                   │  支持 Server Push               │
│                     │  只能客户端请求           │  服务器主动推送资源              │
├─────────────────────┼──────────────────────────┼─────────────────────────────────┤
│  流优先级            │  不支持                   │  支持请求优先级                  │
│                     │                          │  重要资源优先传输                │
└─────────────────────┴──────────────────────────┴─────────────────────────────────┘
```

---

## 四、HTTP/2 核心特性详解

### 4.1 多路复用

```
┌──────────────────────────────────────────────────────────────────────────────────┐
│                          多路复用 vs 管道化                                       │
├──────────────────────────────────────────────────────────────────────────────────┤
│                                                                                  │
│  HTTP/1.1 管道化 (有队头阻塞):                                                   │
│  ┌────────────────────────────────────────────────────────────────────────────┐ │
│  │  请求:  Req1 ──→ Req2 ──→ Req3                                             │ │
│  │  响应:  Res1 ────────→ Res2 ──→ Res3                                       │ │
│  │              ↑                                                              │ │
│  │         Res1 慢，Res2/3 必须等待                                            │ │
│  └────────────────────────────────────────────────────────────────────────────┘ │
│                                                                                  │
│  HTTP/2 多路复用 (无队头阻塞):                                                   │
│  ┌────────────────────────────────────────────────────────────────────────────┐ │
│  │  Stream 1: ──■──■──────■──                                                 │ │
│  │  Stream 2: ────■──■────────                                                │ │
│  │  Stream 3: ■────────■──■──                                                 │ │
│  │                                                                            │ │
│  │  每个请求/响应是一个 Stream                                                 │ │
│  │  Stream 拆分为多个 Frame，交错传输                                          │ │
│  │  Frame 带有 Stream ID，接收端重新组装                                       │ │
│  └────────────────────────────────────────────────────────────────────────────┘ │
│                                                                                  │
└──────────────────────────────────────────────────────────────────────────────────┘
```

### 4.2 头部压缩

```
┌──────────────────────────────────────────────────────────────────────────────────┐
│                          HPACK 头部压缩                                           │
├──────────────────────────────────────────────────────────────────────────────────┤
│                                                                                  │
│  HTTP/1.1 问题: 头部冗余                                                         │
│  ┌────────────────────────────────────────────────────────────────────────────┐ │
│  │  每次请求都携带完整头部:                                                    │ │
│  │  GET / HTTP/1.1                                                            │ │
│  │  Host: example.com                                                          │ │
│  │  Cookie: session=abc123...                   (可能几KB)                     │ │
│  │  User-Agent: Mozilla/5.0...                  (固定不变)                     │ │
│  │  Accept: text/html,application/json...       (固定不变)                     │ │
│  └────────────────────────────────────────────────────────────────────────────┘ │
│                                                                                  │
│  HTTP/2 HPACK 压缩:                                                              │
│  ┌────────────────────────────────────────────────────────────────────────────┐ │
│  │  1. 静态表: 61个常见头部字段预定义索引                                      │ │
│  │     :method: GET  →  索引 2                                                 │ │
│  │     :path: /     →  索引 4                                                  │ │
│  │                                                                            │ │
│  │  2. 动态表: 连接维度，缓存新增的头部                                        │ │
│  │     第一次: Cookie: session=abc ──→ 存入动态表                              │ │
│  │     后续: 只发索引号                                                        │ │
│  │                                                                            │ │
│  │  3. 霍夫曼编码: 对头部值进行压缩                                            │ │
│  │     压缩率可达 85%+                                                         │ │
│  └────────────────────────────────────────────────────────────────────────────┘ │
│                                                                                  │
└──────────────────────────────────────────────────────────────────────────────────┘
```

---

## 五、面试回答

### 30秒版本

> **HTTP/1.0 → 1.1**：
> - 短连接 → 长连接（Keep-Alive）
> - 新增 Host 头部（虚拟主机）
> - 支持分块传输、断点续传
>
> **HTTP/1.1 → 2.0**：
> - 文本 → 二进制（帧）
> - 多路复用：一个连接并行多个请求，消除队头阻塞
> - HPACK 头部压缩：静态表 + 动态表 + 霍夫曼编码
> - 服务器推送：主动推送资源

### 1分钟版本

> **HTTP/1.0 vs 1.1**：
> - **长连接**：1.0 每次请求新建 TCP 连接；1.1 默认 Keep-Alive 复用连接
> - **Host 头部**：1.1 必须携带，支持虚拟主机
> - **管道化**：1.1 支持同时发送多个请求，但响应必须按序返回（队头阻塞）
> - **分块传输**：1.1 支持边生成边发送
> - **缓存控制**：1.1 新增 ETag、Cache-Control
>
> **HTTP/1.1 vs 2.0**：
> - **二进制格式**：请求/响应拆分为 Frame，解析更快
> - **多路复用**：一个 TCP 连接并行处理多个 Stream，消除 HTTP 层队头阻塞
> - **头部压缩**：HPACK 算法（静态表 + 动态表 + 霍夫曼），压缩率 85%+
> - **服务器推送**：请求 HTML 时，服务器主动推送 CSS/JS
> - **流优先级**：重要资源优先传输
>
> **注意**：HTTP/2 仍存在 TCP 层队头阻塞（丢包时），HTTP/3 用 QUIC（基于 UDP）解决。
